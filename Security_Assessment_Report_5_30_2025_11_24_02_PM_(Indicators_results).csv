"ShortName","Name","SI version","Target","Status","Runtime","Score","Severity","Weight","Category","MITRE ATT&CK_1","MITRE ATT&CK_2","MITRE ATT&CK_3","MITRE ATT&CK_4","ANSSI_1","ANSSI_2","ANSSI_3","MITRE D3FEND_1","MITRE D3FEND_2","Description","Likelihood of compromise","Result message","Number of results","Result","Remediation"
"SI000106","Inheritance enabled on AdminSDHolder object","1.124.1","AD","Pass","00:00:04:36","100","Critical","10","AD Delegation","Defense Evasion","Privilege Escalation","","","","","","","","This indicator checks for inheritance enabled on the access control list (ACL) of the AdminSDHolder object.","The AdminSDHolder object in Active Directory holds the permissions that will be applied to privileged groups and users, including Domain Admins. By default, permissions on privileged users are more restrictive to protect them from compromise. If an organization adjusts the permissions on the AdminSDHolder object, including enabling inheritance, they may weaken the security of these privileged users.
An attacker may discover these weaker permissions on privileged users and groups, and with a greater surface area, an attacker has a stronger chance of formulating attack paths to compromise users such as a Domain Admin, and then compromising Active Directory.ReferencesAdminSDHolder to improve Active Directory Security | Semperis","No evidence of exposure.","0","","None"
"SI000055","Permission changes on AdminSDHolder object","1.124.1","AD","IOE Found","00:00:04:28","0","Critical","10","AD Delegation","Defense Evasion","Privilege Escalation","","","vuln1_permissions_adminsdholder","vuln1_privileged_members_perm","","","","This indicator checks for inheritance modifications on the access control list (ACL) of the AdminSDHolder object.","The AdminSDHolder object in Active Directory holds the permissions that will be applied to privileged groups and users, including Domain Admins. By default, permissions on privileged users are more restrictive to protect them from compromise. If an organization adjusts the permissions on the AdminSDHolder object, they may weaken the security of these privileged users.
An attacker may discover these weaker permissions on privileged users and groups, and with a greater surface area, an attacker has a stronger chance of formulating attack paths to compromise users such as a Domain Admin, and then compromising Active Directory.ReferencesAdminSDHolder to improve Active Directory Security | Semperis","Found 1 domains with AdminSDHolder container permission changes in the last 6 months.","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000055)","Check the permissions on the AdminSDHolder container and search for abnormal ACE \ owner."
"SI000082","Changes to AD Display Specifiers in the past 90 days","1.124.1","AD","Pass","00:00:04:77","100","Informational","3","AD Delegation","Execution","Defense Evasion","","","","","","","","This indicator looks for changes made in the past 90 days to the adminContextMenu attribute on AD display specifiers. This attribute controls the right-click menus presented to users in the domain using MMC tools such as AD Users and Computers. Modifying these attributes can potentially allow attackers to get users to run arbitrary code if those menu options are clicked.","Attackers may utilize context menus as a stealthy way of getting various users in a domain to execute code. Modifying this attribute requires special permissions granted by default only to Domain Admins and Enterprise Admins and also requires the user to click on the illicit context menu item. See the this blog post for additional information. (see this writeup for additional information).","No evidence of exposure.","0","","None"
"SI000047","Changes to default security descriptor schema in the last 90 days","1.124.1","AD","Pass","00:00:04:95","100","Warning","7","AD Delegation","Defense Evasion","Privilege Escalation","","","","","","Detect - Domain Account Monitoring","","This indicator detects changes made to the default security descriptor schema in the last 90 days. If an attacker gets access to the schema instance in a given forest, they can make changes to the defaultSecurityDescriptor attribute on any AD object class. These changes would then propagate as new default Access Control Lists (ACLs) on any newly created object in AD, potentially weakening AD security posture.","Changes to the default security descriptor are not common. An admin should know that the change was made and be able to articulate the reason for the change. If the change was not intentional, the likelihood of compromise is very high. The chances of compromise are lower if the change hardens the setting instead of weakening it.","No evidence of exposure.","0","","None"
"SI000050","Domain Controller owner is not an administrator","1.124.1","AD","Pass","00:00:11:86","100","Warning","6","AD Delegation","Credential Access","Privilege Escalation","","","vuln1_permissions_dc","","","Harden - System Configuration Permissions","","This indicator looks for Domain Controller computer accounts whose owner is not a Domain Admins, Enterprise Admins, or built-in Administrator account.","Control of DC machine accounts allows for an easy path to compromising the domain. While Domain Controller objects are typically created during DCPromo by privileged accounts, if an accidental ownership change occurs on a DC object, it can have large consequences for security of the domain, since object owners can change permissions on the object to perform any number of actions.","No evidence of exposure.","0","","None"
"SI000092","Non-default access to DPAPI key","1.124.1","AD","Pass","00:00:12:14","100","Warning","7","AD Delegation","Credential Access","","","","vuln1_permissions_dpapi","","","Harden - User Account Permissions","","This indicator uses API calls to check whether each DC has non-default principals permitted to retrieve the domain DPAPI backup key (using LsaRetrievePrivateData).","An attacker could recover all domain data encrypted via DPAPI, if they gain access to such data.","No evidence of exposure.","0","","None"
"SI000056","Enterprise Key Admins with full access to domain","1.124.1","AD","Pass","00:00:12:10","100","Warning","7","AD Delegation","Credential Access","Lateral Movement","Privilege Escalation","","vuln2_adupdate_bad","","","Harden - User Account Permissions","","This indicator looks for evidence of a bug in certain versions of Windows Server 2016 Adprep that granted undue access to the Enterprise Key Admins group.","This issue was corrected in a subsequent release of Server 2016 and may not exist in your environment, but checking for it is definitely warranted, since it grants this group the ability to replicate all changes from AD (DCSync Attack).","No evidence of exposure.","0","","None"
"SI000124","Foreign Security Principals in Privileged Group","1.124.1","AD","Pass","00:00:12:78","100","Warning","5","AD Delegation","Defense Evasion","Persistence","","","","","","Detect - Domain Account Monitoring","","This indicator looks for members of privileged groups which are Foreign Security Principals. Special care should be taken when including accounts from other domains as members of privileged groups.","While not immediately indicative of an attack, privileged users that are not clearly marked as such (adminCount =1) represent an exposure in that they may be used nefariously without being detected. Since Foreign Security Principals do not have the adminCount attribute, they could miss being detected by some security auditing tools. Additionally, an attacker may add a privileged account and attempt to hide it using this method.","No evidence of exposure.","0","","None"
"SI000084","gMSA not in use","1.124.1","AD","IOE Found","00:00:12:77","94","Informational","4","AD Delegation","Credential Access","","","","","","","","","This indicator checks if there are enabled group Managed Service Account (gMSA) objects in the domain. For more information on gMSA see the Microsoft article: here.","The group Managed Service Account (gMSA) feature in Windows Server 2016 allows automatic rotation of passwords for service accounts, making them much more difficult for attackers to compromise. The feature should be used whenever possible for service accounts.","Found 1 domains with no gMSA objects enabled.","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000084)","Group Managed Service Accounts should be used to protect service accounts. See description for more information."
"SI000083","Non-privileged users with access to gMSA passwords","1.124.1","AD","Pass","00:00:15:72","100","Warning","6","AD Delegation","Credential Access","","","","","","","","","This indicator looks for principals listed within MSDS-groupMSAmembership that are not in the built-in admin groups.","An attacker that controls access to the gMSA account can retrieve passwords for resources managed with gMSA.","No evidence of exposure.","0","","None"
"SI000012","Built-in guest account is enabled","1.124.1","AD","Pass","00:00:15:52","100","Informational","2","AD Delegation","Discovery","Reconnaissance","","","vuln2_guest","","","Evict - Account Locking","","This indicator checks if the built-in Active Directory 'guest' account is enabled. The guest account allows for accounts with no password access to the domain and is disabled in most AD environments.","Attackers can take advantage of a guest account to enumerate open shares that are accessible to the 'Everyone' setting, as is often the case. Additionally, attackers may utilize the limited access these accounts provide to conduct additional scanning for vulnerable users, shares and other network resources.","No evidence of exposure.","0","","None"
"SI000089","Users with permissions to set Server Trust Account","1.124.1","AD","Pass","00:00:15:55","100","Critical","8","AD Delegation","Privilege Escalation","","","","","","","","","Checks for permissions on the domain NC head that enables a user to set a UAC flag - Server_Trust_Account on computer objects. This flag gives that computer object special permissions similar to a domain controller.","A persistence technique originally reported by Stealthbits researchers, an attacker that is able to seed authenticated user(s) with these permissions can then utilize their access to these users to 'promote' any computer they control to Domain Controller status, enabling privilege escalation to AD services and carrying out credential access attacks such as DCSync. More information available here.","No evidence of exposure.","0","","None"
"SI000018","Non default value on ms-Mcs-AdmPwd SearchFlags","1.124.1","AD","Pass","00:00:15:62","100","Warning","7","AD Delegation","Credential Access","","","","","","","","","Some flags on the ms-Mcs-AdmPwd schema may inadvertently cause passwords to be visible to users allowing an attacker to use it as stealthy backdoor. This indicator looks for any changes to default searchFlags, which may create an exposure. Detection of changes to the default will result in a score of 80 for this indicator, signifying that a review should be conducted. Any removal of the default flags will result in a score of 0 due to their importance to security.","Even though schema changes are not common, a targeted schema change like this can leave the administrator passwords of 100s or 1000s of computers vulnerable to non-privileged users.","No evidence of exposure.","0","","None"
"SI000046","Objects in privileged groups without adminCount=1 (SDProp)","1.124.1","AD","Pass","00:00:19:37","100","Informational","4","AD Delegation","Defense Evasion","Persistence","","","","","","","","This indicator looks for objects in privileged groups with AdminCount not equal to 1. AdminCount is an object flag that is set by the SDProp process (run by default every 60 minutes) if that object's DACLs are modified to sync with the AdminSDHolder object through inheritance. If an object within these groups has an AdminCount not equal to 1 then it could signify that the DACLs were manually set (no inheritance) or that there is an issue with SDProp. For more information see: https://docs.microsoft.com/en-us/previous-versions/technet-magazine/ee361593(v=msdn.10)","While not immediately indicative of an attack, privileged users that are not clearly marked as such (adminCount =1) represent an exposure in that they may be used nefariously without being detected. Additionally, an attacker may add a privileged account and attempt to hide it using this method.","No evidence of exposure.","0","","None"
"SI000035","Changes to MS LAPS read permissions","1.124.1","AD","Pass","00:00:16:96","100","Informational","3","AD Delegation","Credential Access","Lateral Movement","","","","","","Harden - User Account Permissions","","This indicator looks for permissions on computer accounts that could allow inadvertent exposure of local administrator accounts in environments that use the Microsoft LAPS solution (https://www.microsoft.com/en-us/download/details.aspx?id=46899). These permissions include Read access to ms-Mcs-AdmPwd as well as Write DACL and Owner (which would allow provisioning the read access). LAPS provides a method to rotate local administrator account passwords on servers and workstations.","Only authorized administrative users should have access to LAPS passwords. Attackers may use this capability to laterally move through a domain using local compromised administrator accounts.","No evidence of exposure.","0","","None"
"SI000021","Non-default principals with DC Sync rights on the domain","1.124.1","AD","IOE Found","00:00:23:08","0","Critical","8","AD Delegation","Credential Access","","","","vuln1_permissions_naming_context","","","","","Any security principals with Replicate Changes All and Replicate Directory Changes permissions on the domain naming context object can potentially retrieve password hashes for any and all users in an AD domain ('DCSync' attack). Additionally, Write DACL / Owner also allows assignment of these privileges. This can then lead to all kinds of credential-theft based attacks, including Golden and Silver Ticket attacks.","DCSync is an attack for accessing credentials through this method. If an attacker gets ahold of these privileges, it is straight-forward to retrieve credential material using tools like Mimikatz, for any user in a domain.","Found 4 objects with replication permissions.","4","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000021)","Ensure that there are no unnecessary replication permissions and investigate suspicious permissions. Under certain situations (e.g. Microsoft PAM Tiering), an empty group may appear in the results - this is normal but keep in mind that this is a highly privileged group."
"SI000025","Privileged objects with unprivileged owners","1.124.1","AD","Pass","00:00:28:33","100","Warning","6","AD Delegation","Privilege Escalation","","","","vuln1_permissions_adminsdholder","","","","","If a privileged object (as determined by adminCount=1) is owned by an account that is unprivileged, then any compromise of that unprivileged account could result in those privileged objects' delegation being modified, since owners can override any delegation on an object, if only temporarily.","Most privileged objects are owned by privileged groups or users. But if a privileged object were to be owned by an unprivileged account, it could be easily taken over. And even though SDProp might correct any delegation done by an attacker who has compromised an owner, the attacker could have up to 1 hour to perform any changes on the privileged object (e.g. group membership changes or password changes) before SDProp corrects it.","No evidence of exposure.","0","","None"
"SI000011","Unprivileged users can add computer accounts to the domain","1.124.1","AD","IOE Found","00:00:28:37","96","Informational","3","AD Delegation","Credential Access","Lateral Movement","","","","","","","","This indicator checks for an AD configuration that allows unprivileged domain members to add computer accounts to the domain. By default, members of the Authenticated Users group can add up to 10 machine accounts to a domain. If the ms-DS-MachineAccountQuota attribute on the domain naming context head is not set to 0, regular users have this ability.The ability to do this confers certain rights on those created machine accounts that can be abused by a variety of Kerberos-based attacks. Note: This configuration may be enabled but be already mitigated by GPO settings (User Right: 'Add workstations to domain' configured with only high-privileged group(s)/account(s)) linked to Domain Controllers OU that are not checked by this indicator.","The ability to add computer accounts to a domain without restrictions or monitoring present opportunities for attackers to add their own accounts or take advantage of uncontrolled computers with vulnerabilities, thereby extending their reach and entrenching themselves in the environment.","Found 1 domains in which regular users can add computer accounts.","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000011)","Set the ms-DS-MachineAccountQuota attribute on the domain NC head to 0 to disable regular users' ability to add computer accounts."
"SI000098","Abnormal Password Refresh","1.124.1","AD","Pass","00:00:03:09","100","Warning","5","Account Security","Credential Access","Persistence","","","","","","","","This indicator looks for user accounts with a recent pwdLastSet change without a corresponding password replication.","If an administrator marks the option 'User must change password at next logon' and then clears (i.e. unchecks) the option later, the pwdLastSet is updated without the password actually being changed. This could be an administrative error or an attempt to bypass the organization's password policy.","No evidence of exposure.","0","","None"
"SI000049","Built-in domain Administrator account with old password (180 days)","1.124.1","AD","Pass","00:00:03:89","100","Informational","4","Account Security","Credential Access","","","","vuln1_password_change_priv","","","Harden - Strong Password Policy","","This indicator checks if the password of the built-in Domain Administrator account is older than 180 days.","The built-in Domain Administrator account is a well-known SID that is easily discoverable, regardless of attempts to obfuscate the account, such as renaming it.
It is recommended that this account is not used for administration of Active Directory, but due to lack of use, this account in many organizations also goes unmonitored. Attackers may target this account for brute force password attacks.ReferencesSecurity identifiers | Microsoft Learn","No evidence of exposure.","0","","None"
"SI000028","Built-in domain Administrator account used within the last two weeks","1.124.1","AD","IOE Found","00:00:04:79","91","Warning","5","Account Security","Credential Access","","","","","","","Detect - Credential Compromise Scope Analysis","Harden - Strong Password Policy","The Domain Administrator account should only be used for initial build activities and, when necessary, disaster recovery. This indicator checks to see if the lastLogonTimestamp for the built-in Domain Administrator account has been updated within the last two weeks. If so, it could indicate that the user has been compromised.","If best practices are followed and domain Admin is not used, this would indicate a compromise. Ensure any logins to the built-in Domain Administrator account are legitimate and accounted for. If not accounted for, a breach is likely and should be investigated.","Found 1 domains in which the built-in administrator was used recently.","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000028)","Ensure that the built-in domain Administrator account is not used regularly and has a complex password known only to highly privileged admins."
"SI000061","Computer Accounts in Privileged Groups","1.124.1","AD","Pass","00:00:07:55","100","Warning","6","Account Security","Privilege Escalation","","","","","","","","","This indicator looks for computer accounts that are members of built-in privileged groups.","If a computer account is a member of a domain privileged group, then anyone that compromises that computer account (i.e. becomes administrator) can act as a member of that group. Generally speaking, there is little reason for normal computer accounts to be part of privileged groups.","No evidence of exposure.","0","","None"
"SI000039","Privileged users that are disabled","1.124.1","AD","Pass","00:00:04:78","100","Informational","3","Account Security","Privilege Escalation","","","","","","","Harden - User Account Permissions","","This indicator looks for privileged user accounts, as indicated by their adminCount attribute set to 1, that are disabled. If a privileged account is disabled, it should be removed from its privileged group(s) to prevent inadvertent misuse.","When a user is disabled, it tends to not be monitored as closely as active accounts. If this user is also a privileged user, then it becomes a target for takeover if an attacker can enable the account.","No evidence of exposure.","0","","None"
"SI000038","Enabled admin accounts that are inactive","1.124.1","AD","Pass","00:00:11:72","100","Warning","4","Account Security","Credential Access","Privilege Escalation","","","vuln1_user_accounts_dormant","","","Evict - Account Locking","","This indicator looks for admin accounts that are enabled, but have not logged in for the past 90 days. Attackers who can compromise these accounts may be able to operate unnoticed.","While the presence of an unused admin account is not automatically a problem, removing these accounts reduces the attack surface of AD.","No evidence of exposure.","0","","None"
"SI000110","Ephemeral Admins","1.124.1","AD","Pass","00:00:12:13","100","Informational","3","Account Security","Persistence","","","","","","","Harden - User Account Permissions","","This indicator looks for users which were added and removed from an admin group within a 48 hour span of time. Such short-lived accounts may indicate malicious activity.","In most environments, management of admin accounts is tightly controlled and audited. This indicator provides a fast method to create a list of ephemeral admins for investigation and review.","No evidence of exposure.","0","","None"
"SI000103","FGPP not applied to Group","1.124.1","AD","Pass","00:00:12:04","100","Warning","5","Account Security","Persistence","Credential Access","","","","","","Harden - Strong Password Policy","","This indicator looks for FGPP targeted to a Universal or Domain Local group.","Changing a group's scope settings from Global group to Universal or Domain Local group, will result in FGPP settings no longer applying to that group, and decreasing its password security controls.","No evidence of exposure.","0","","None"
"SI000064","Forest contains more than 50 privileged accounts","1.124.1","AD","Pass","00:00:15:57","100","Warning","5","Account Security","Privilege Escalation","Reconnaissance","","","vuln1_privileged_members","","","","","This indicator counts the number of privileged user accounts defined in the forest, where 50 is deemed the upper limit for these types of accounts. A privileged account is defined as any user with the AdminCount attribute set to 1.","In general, the more privileged accounts you have, the more opportunities there are for attackers to compromise one of those accounts. 50 is an arbitrary number, but the number should reflect the absolute maximum allowed. If business needs dictate many privileged accounts, consider implementing a tiered administration model to further isolate those privileged accounts and their potential impact from compromise.","No evidence of exposure.","0","","None"
"SI000044","AD objects created within the last 10 days","1.124.1","AD","IOE Found","00:00:15:99","100","Informational","1","Account Security","Lateral Movement","Persistence","","","","","","Detect - Domain Account Monitoring","","This indicator looks for any AD objects that were created within the last 10 days. It is meant to be used for threat hunting, post-breach investigation or compliance validation.","In some environments, object creation happens consistently; however, recently added accounts should be reviewed to ensure they are legitimate.","Found 6 objects that were created in the last 10 days.","6","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000044)","Ensure that the new objects are known and legitimate.<br><br>MITRE D3fend based on the reference: <a href='https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-user-account-management' target='_blank'>audit-user-account-management of Microsoft</a>"
"SI000033","Recent privileged account creation activity","1.124.1","AD","Pass","00:00:16:30","100","Informational","3","Account Security","Persistence","","","","","","","Detect - Domain Account Monitoring","","This indicator looks for any users or groups that were created within the last month. Privileged accounts and groups are defined by having their adminCount attribute set to 1.","In most environments, creation of privileged accounts and groups is tightly controlled and audited. This indicator provides a fast method to create a list of new privileged accounts (where adminCount = 1) for investigation and review.","No evidence of exposure.","0","","None"
"SI000034","Unprivileged accounts with adminCount=1","1.124.1","AD","Pass","00:00:17:18","100","Informational","3","Account Security","Privilege Escalation","","","","","","","","","This indicator looks for any users or groups that may have been under the control of SDProp (adminCount=1) but are no longer members of privileged groups and should not be considered privileged.","The most common scenario for this behavior is if a user is moved from a privileged group to a non-privileged one and their adminCount variable is not reset. While this is benign, it may cause issues for security controls that monitor privileged users and reduces the overall hygiene of the environment. In rare cases, this might also be evidence of an attacker that attempted to cover their tracks and remove a user they used for compromise.","No evidence of exposure.","0","","None"
"SI000014","Users and computers with non-default Primary Group IDs","1.124.1","AD","Pass","00:00:16:58","100","Informational","3","Account Security","Privilege Escalation","","","","vuln1_primary_group_id_1000","vuln3_primary_group_id_nochange","","","","This indicator returns a list of users and computers whose Primary Group IDs (PGIDs) are not the defaults for domain users and computers. Users created in the domain will have a default PGID of 513 (Domain Users) or 514 (Domain Guests) while computers are 515 (Domain Computers), 516 (Domain Controllers), or 521 (RODC). The Primary Group ID is not automatically changed when a user is moved to a different group (i.e. a user moved into Domain Admins will not be assigned PGID 512). This fact can be used to hide users with privileges to systems that rely on PGID, while hiding the user from queries that rely on enumerating the member attribute without the PGID. Additionally, group objects' member attribute will not list the user objects with PGID of those groups.","Modifying the Primary Group ID is a stealthy way for an attacker to escalate privileges without triggering member attribute auditing for group membership changes.","No evidence of exposure.","0","","None"
"SI000078","Users and computers without readable PGID","1.124.1","AD","Pass","00:00:16:76","100","Warning","5","Account Security","Defense Evasion","","","","","","","","","This indicator finds users and computers for whom it can't read the PGID. This may be due to the default permission of Read access having been removed, which could indicate an attempt to hide the user (in combination with removal of the memberOf attribute).","Can be used for hiding users in certain groups (non SDProp protected).","No evidence of exposure.","0","","None"
"SI000037","Users with old passwords","1.124.1","AD","Pass","00:00:17:23","100","Informational","2","Account Security","Credential Access","Persistence","","","","","","Harden - Strong Password Policy","","This indicator looks for user accounts whose password has not changed in over 180 days. This could make these account ripe for password guessing attacks.","Stale passwords that aren't changed over a long period of time and are not supported by multi-factor authentication are ripe targets for attackers. These present opportunities for attackers to move laterally through the environment or elevate privileges.","No evidence of exposure.","0","","None"
"SI000062","Admins with old passwords","1.124.1","AD","Pass","00:00:17:53","100","Informational","2","Account Security","Discovery","","","","vuln1_password_change_priv","","","Harden - Strong Password Policy","","This indicator looks for admin accounts whose password has not changed in over 180 days. This could make these accounts ripe for password guessing attacks.","An administrator account whose password hasn't changed in a while could be a target for attackers looking for privileged accounts that can provide elevated access to the environment.","No evidence of exposure.","0","","None"
"SI000150","Operators Groups that are not empty","1.124.1","AD","IOE Found","00:00:18:07","4","Warning","6","Account Security","Privilege Escalation","Credential Access","","","","","","Harden - User Account Permissions","","This indicator checks if the Account Operators, Server Operators, Backup Operators and Print Operators groups in Active Directory are populated.","The operator groups in Active Directory, Account Operators, Server Operators, Backup Operators, and Print Operators, all provide users within these groups certain privileges over different critical domain resources in Active Directory and different levels of access to domain controllers.
An attacker may target users in these groups for further privilege escalation and lateral movement in Active Directory.ReferencesActive Directory security groups | Microsoft Learn","Found 8 Members in Operator Groups","8","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000150)","It is recommended to have these groups empty. Assign administrators into administrators group. Other accounts should have proper delegation rights in an OU or in the scope they are managing."
"SI000104","Changes to Pre-Windows 2000 Compatible Access Group membership","1.124.1","AD","IOE Found","00:00:20:10","83","Warning","5","Account Security","Privilege Escalation","","","","","","","","","This indicator looks for changes to the built-in group 'Pre-Windows 2000 Compatible Access'. This group grants read-only access to Active Directory. For more information see the following Semperis blog entry.","As part of a layered approach to security and to ensure that non-authenticated users cannot read Active Directory, it's best to ensure this group does not contain the 'Anonymous Logon' or 'Everyone' groups.","Found 2 objects in the Pre-Windows 2000 Compatible Access group.","2","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000104)","Confirm that any addition or removals from Pre-Windows 2000 Compatible Access group are valid and properly accounted for."
"SI000043","Changes to privileged group membership in the last 7 days","1.124.1","AD","Pass","00:00:20:02","100","Warning","5","Account Security","Privilege Escalation","Persistence","","","","","","","","This indicator looks for changes to the built-in privileged groups within the last 7 days, which could indicate attempts to escalate privilege.","Recent additions or deletions to privileged group members could be normal operational changes or could indicate attempts at persistence or cleaning up of tracks after an attack (e.g. detection of temporary group membership changes).","No evidence of exposure.","0","","None"
"SI000096","Privileged Users with Weak Password Policy","1.124.1","AD","IOE Found","00:00:26:66","0","Critical","8","Account Security","Discovery","","","","vuln2_privileged_members_password","","","Harden - Strong Password Policy","","This indicator looks for privileged users in each domain that don't have a strong password policy enforced, according to ANSSI framework. It checks both FGPP (Fine-Grained Password Policy) and the password policy applied to the domain. A strong password as defined by ANSSI is at least 8 characters long and updated no later than every 3 years.","Weak passwords are easier to crack via brute-force attacks, they can provide attackers opportunities for moving laterally or escalating privileges. The risk is even higher for privileged accounts, for when easily compromised, they improve the attacker's chance to quickly advance within the network.","Found 23 privileged users who do not comply with strong password policies.","23","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000096)","Apply appropriate password policies for privileged users.<br><br>MITRE D3fend based on the reference: <a href='https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63-3.pdf'>NIST.SP.800-63-3</a>"
"SI000020","Protected Users group not in use","1.124.1","AD","IOE Found","00:00:20:08","83","Informational","1","Account Security","Credential Access","","","","vuln3_protected_users","","","","","This indicator checks if privileged users are in the Protected Users security group.","The Protected Users security group was introduced in Server 2012 R2 Active Directory to minimize credential exposure for privileged accounts. As a defense in depth measure privileged accounts, such as Domain Admins, should be added to the Protected Users security group.
Attackers targeting privileged accounts in Active Directory will find a much higher level of friction in certain types of attempts to compromise the accounts due to the protections offered.ReferencesProtected Users Security Group | Microsoft Learn","Found 17 privileged users that are not members of the Protected Users group.","17","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000020)","Ensure that all privileged users are members of the Protected Users group. If using a pre 2012-R2 schema, then the protected users group does not exist. This is an exposure, but the remediation is to upgrade the schema."
"SI000060","Recent sIDHistory changes on objects","1.124.1","AD","Pass","00:00:21:32","100","Warning","5","Account Security","Privilege Escalation","","","","vuln2_sidhistory_dangerous","","","","","This indicator checks for any recent changes to sIDHistory on objects.","Security Identifier (SID) history is used by Active Directory to maintain access rights during domain migrations.
An attacker can abuse SID history by injecting a privileged SID into the sIDHistory of another user object, allowing the user to act with the same privileges. Writing to the sIDHistory does require privileges in Active Directory, so it is likely that Active Directory is already compromised; this method is primarily used by an attacker for gaining persistence.ResourcesHow to Defend Against SID History Injection | Semperis Guides","No evidence of exposure.","0","","None"
"SI000351","Shadow Credentials on privileged objects","1.124.1","AD","IOE Found","00:00:27:25","15","Warning","6","Account Security","Credential Access","Lateral Movement","","","","","","Harden - User Account Permissions","","This indicator looks for users with write access to the msDS-KeyCredentialLink attribute of privileged users and DCs.","Attackers who can write to these privileged objects and Kerberos PKINIT is enabled will be able to elevate privileges to them.","Found 7 privileged objects that can have their msDS-KeyCredentialLink written to.","7","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000351)","Make sure these users should have this write access and that it is necessary, if it's not remove them."
"SI000068","Trust accounts with old passwords","1.124.1","AD","Pass","00:00:28:06","100","Informational","3","Account Security","Initial Access","","","","vuln2_trusts_accounts","","","Harden - Strong Password Policy","","This indicator looks for trust accounts whose password has not changed within the last year. This could mean that a trust relationship was removed but its corresponding trust account wasn't cleaned up.","Trust accounts facilitate authentication across trusts. As such they should be protected just like privileged user accounts. Normally trust account passwords are rotated automatically so a trust account without a recent password change could indicate an orphaned trust account.","No evidence of exposure.","0","","None"
"SI000024","Unprivileged principals as DNS Admins","1.124.1","AD","IOE Found","00:00:29:02","0","Warning","7","Account Security","Execution","Privilege Escalation","","","vuln1_permissions_msdns","vuln1_dnsadmins","","","","This indicator looks for any member of the DnsAdmins group that is not a privileged user. DnsAdmins itself is not considered a privileged group and is not protected by the AdminSDHolder SDProp mechanism. However as some research has shown, a member of this group can remotely load a DLL onto a domain controller running DNS and execute code as SYSTEM.","Administration of DNS is often delegated to non-AD administrators (i.e., administrators with job responsibilities in networking, DNS, DHCP, etc.). These administration accounts may not have the same security controls as the AD administrator accounts, making them prime targets for compromise. For more information on how DNS admins can abuse privileges see this blog post.","Found 12 objects which are not privileged but are members of the DNS Admins group.","12","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000024)","Remove unprivileged principals that are a member of the DNS Admins group."
"SI000075","User accounts that use DES encryption","1.124.1","AD","Pass","00:00:28:46","100","Informational","4","Account Security","Credential Access","","","","vuln2_kerberos_properties_deskey","","","","","This indicator identifies user accounts with the 'Use Kerberos DES encryption types for this account' flag set. DES is an older cipher with a 56-bit key length that is relatively easy to crack. The only legitimate use for this flag is to support older systems and environments that only support DES.","Attackers can easily crack DES passwords using widely available tools, making these accounts ripe for takeover.","No evidence of exposure.","0","","None"
"SI000029","Users with Password Never Expires flag set","1.124.1","AD","Pass","00:00:28:54","100","Informational","1","Account Security","Credential Access","","","","vuln2_dont_expire","","","Harden - Strong Password Policy","","This indicator identifies user accounts where the Password Never Expires flag is set. These accounts can be targets for brute force password attacks, given that their passwords may not be strong when they were set. These accounts also tend to be service accounts with privileged access to applications and services, including Kerberos-based services.","Passwords that never expire may be weak and easier to crack. These credentials can provide attackers opportunities for moving laterally or escalating privileges.","No evidence of exposure.","0","","None"
"SI000067","Privileged accounts with a password that never expires","1.124.1","AD","Pass","00:00:28:64","100","Warning","6","Account Security","Credential Access","Privilege Escalation","","","vuln1_dont_expire_priv","","","Harden - Strong Password Policy","","This indicator identifies privileged accounts (adminCount attribute set to 1) where the Password Never Expires flag is set.","User accounts whose passwords never expire are ripe targets for brute force password guessing. If these users are also administrative or privileged accounts, this makes them even more of a target.","No evidence of exposure.","0","","None"
"SI000074","User accounts with password not required","1.124.1","AD","Pass","00:00:28:54","100","Warning","6","Account Security","Lateral Movement","","","","","","","Harden - Strong Password Policy","","This indicator identifies user accounts where a password is not required.","Accounts with weak access controls are often targeted by attackers seeking to move laterally or gain a persistent foothold within the environment.","No evidence of exposure.","0","","None"
"SI000076","User accounts that store passwords with reversible encryption","1.124.1","AD","Pass","00:00:28:76","100","Informational","4","Account Security","Credential Access","","","","vuln3_reversible_password","","","Harden - Strong Password Policy","","This indicator looks for user accounts with the ENCRYPTED_TEXT_PWD_ALLOWED flag enabled. The secure way of storing passwords is by utilizing one-way encryption where it is mathematically impossible to derive the original password from the ciphertext. This setting encrypts the source password such that it is possible to derive the original. This setting is used when an application or service utilizes authentication protocols that require the original password, e.g. CHAP or IAS.","Attackers may be able to derive these users' passwords from the ciphertext and take over these accounts.","No evidence of exposure.","0","","None"
"SI000027","Users with Kerberos pre-authentication disabled","1.124.1","AD","IOE Found","00:00:29:02","0","Warning","5","Account Security","Credential Access","","","","vuln1_kerberos_properties_preauth_priv","vuln2_kerberos_properties_preauth","","","","This indicator identifies users with Kerberos pre-authentication disabled, which exposes them to potential ASREP-Roasting attacks, such as 'Kerberoasting'. please refer to this resource: https://social.technet.microsoft.com/wiki/contents/articles/23559.kerberos-pre-authentication-why-it-should-not-be-disabled.aspx.","If an account has Kerberos pre-authentication disabled, it makes it easier for attackers to send dummy requests to a DC to try and crack its Ticket Granting Ticket (TGT).","Found 115 users with pre-authentication disabled.","115","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000027)","Ensure that pre-authentication is enabled on all users if possible; if not possible, consider reducing their privileges instead."
"SI000314","Unexpected accounts in Cert Publishers Group","1.124.1","AD","IOE Found","00:00:03:87","63","Warning","6","AD Infrastructure Security","Privilege Escalation","Credential Access","","","","","","Harden - User Account Permissions","","This indicator checks to see if the Cert Publishers Group contains members that aren't expected to be there.","Individuals belonging to Cert Publishers Group have the ability to introduce a potentially harmful Certificate Authority (CA) within an ADCS environment, that will be trusted by all clients. Although certificates issued by this CA may not receive automatic trust for client authentication via PKINIT or SChannel, they remain susceptible to exploitation for other malicious purposes. The combination of Cert Publishers membership and write access to NTAuthcertificates poses the greatest risk in such situations, allowing the forging and solicitation of certificates for client authentication against any user in the domain.","Found 3 unexpected members in Cert Publishers Group","3","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000314)","After careful investigation, remove any accounts that do not belong from the Cert Publishers Group."
"SI000030","Anonymous access to Active Directory enabled","1.124.1","AD","Pass","00:00:04:54","100","Warning","7","AD Infrastructure Security","Defense Evasion","Initial Access","Persistence","Privilege Escalation","vuln2_compatible_2000_anonymous","","","Harden - User Account Permissions","","It is possible, though not recommended, to enable anonymous access to AD. This indicator looks for the presence of the flag that enables anonymous access. Anonymous access would allow unauthenticated users to query AD.","Anonymous access to Active Directory allows an attacker to enumerate accounts and perform attacks like password spray, as well as to enumerate the domain to gather information that can model attack paths. This is a significant risk as the complexity of AD often presents many opportunities for attackers and anonymous access allows them an easy way to find such opportunities.","No evidence of exposure.","0","","None"
"SI000052","Anonymous NSPI access to AD enabled","1.124.1","AD","Pass","00:00:04:57","100","Warning","6","AD Infrastructure Security","Initial Access","","","","vuln1_dsheuristics_bad","","","Harden - User Account Permissions","","Anonymous name service provider interface (NSPI) access on AD is a feature that allows anonymous RPC-based binds to AD. This indicator detects when NSPI access is enabled.","NSPI access is rarely ever enabled so if you find it enabled, this should be a cause for concern.","No evidence of exposure.","0","","None"
"SI000091","Dangerous control paths expose certificate containers","1.124.1","AD","Pass","00:00:04:56","100","Warning","7","AD Infrastructure Security","Credential Access","","","","vuln1_adcs_control","","","Harden - Credential Transmission Scoping","","This indicator looks for non-default principals with permissions on the NTAuthCertificates container. This container holds the intermediate CA certificates that can be used to authenticate to AD.","These control paths allow adding a malicious certificate authority, which allow an attacker to authenticate as arbitrary users or services.","No evidence of exposure.","0","","None"
"SI000156","Certificate templates with 3 or more insecure configurations","1.124.1","AD","Pass","00:00:05:02","100","Warning","7","AD Infrastructure Security","Credential Access","Privilege Escalation","","","vuln1_adcs_template_auth_enroll_with_name","","","Detect - Certificate Analysis","","This indicator checks if certificate templates in the forest have a minimum of three insecure configurations - Manager approval is disabled, No authorized signatures are required, SAN enabled, Authentication EKU present.","The following configurations of a certificate template can be exploited by adversaries:>

      1. Manager approval is disabled - new certificates are automatically approved if the user has the correct enrollment rights.>

      2. No authorized signatures are required - CSRs (Certificate Signing Requests) are not signed by any existing authorized certificate.>

      3. SAN (Subject Alternative Name) Enabled - Allowing the creator of a certificate template to specify the subjectAltName in the CSR, thus they can make the request as anyone, even a domain admin.>

      4. Authentication EKU (Enhanced Key Usage) present - if present, the EKU created from the certificate template will allow the user to authenticate with it.","No evidence of exposure.","0","","None"
"SI000090","Dangerous control paths expose certificate templates","1.124.1","AD","Pass","00:00:04:92","100","Warning","7","AD Infrastructure Security","Credential Access","","","","vuln1_adcs_template_control","","","Detect - Certificate Analysis","","This indicators looks for non-default principals with the ability to write properties on a certificate template.","Controlling certificate templates allows one to have the certificate authority issue an arbitrary certificate. It becomes possible to obtain a smartcard authentication certificate for any user, thus stealing his identity.","No evidence of exposure.","0","","None"
"SI000157","Certificate templates that allow requesters to specify a subjectAltName","1.124.1","AD","Pass","00:00:05:24","100","Critical","8","AD Infrastructure Security","Credential Access","Privilege Escalation","","","vuln1_adcs_template_auth_enroll_with_name","","","Detect - Certificate Analysis","","This indicator checks if certificate templates are enabling requesters to specify a subjectAltName in the CSR.","When certificate templates allow requesters to specify a subjectAltName in the CSR, the result is that they can request a certificate as anyone. For example, a domain admin. When that is combined with an authentication EKU present in the certificate template it can become extremely dangerous.","No evidence of exposure.","0","","None"
"SI000054","Computers with older OS versions","1.124.1","AD","Pass","00:00:04:52","100","Informational","4","AD Infrastructure Security","Lateral Movement","Persistence","","","","","","Harden - Software Update","","This indicator looks for machine accounts that are running versions of Windows older than Server 2012-R2 and Windows 8.1","Computers running older and unsupported OS versions could be targeted with known or unpatched exploits.","No evidence of exposure.","0","","None"
"SI000059","Computers with password last set over 90 days ago","1.124.1","AD","Pass","00:00:04:45","100","Warning","6","AD Infrastructure Security","Credential Access","","","","vuln2_password_change_server_no_change_90","","","Harden - Strong Password Policy","","This indicator looks for computer accounts that have not rotated their passwords in the last 90 days. These passwords should be changed automatically every 30 days by default.","Computer accounts should automatically rotate their passwords every 30 days as they are prime targets for attackers. Objects that are not doing this could show evidence of tampering.","No evidence of exposure.","0","","None"
"SI000063","Domain controllers with old passwords","1.124.1","AD","Pass","00:00:04:29","100","Informational","3","AD Infrastructure Security","Privilege Escalation","Resource Development","","","vuln1_password_change_dc_no_change","","","Harden - Strong Password Policy","","This indicator looks for domain controller machine accounts whose password has not been reset in over 45 days. By default, machine accounts including DCs, automatically reset their passwords every 30 days. Any machine accounts with passwords older than that could indicate a DC that is no longer functioning in the domain.","A DC that is not updating its machine account password regularly could be more easily taken over. From an operational standpoint, it could also indicate a communication problem with the rest of the domain.","No evidence of exposure.","0","","None"
"SI000108","Dangerous Trust Attribute Set","1.124.1","AD","Pass","00:00:04:56","100","Warning","7","AD Infrastructure Security","Privilege Escalation","","","","vuln1_trusts_domain_notfiltered","","","Harden - Domain Trust Policy","","This indicator identifies trusts set with either TRUST_ATTRIBUTE_CROSS_ORGANIZATION_ENABLE_TGT_DELEGATION or TRUST_ATTRIBUTE_PIM_TRUST. These bits will either allow a kerberos ticket to be delegated or reduce the protection that SID Filtering provides.","An attacker that has compromised a remote domain can spoof any user or machine in the local domain. This can allow the attacker to access any resource as well as escalate their privileges, thus compromising the entire forest.","No evidence of exposure.","0","","None"
"SI000077","Print spooler service is enabled on a DC","1.124.1","AD","IOE Found","00:00:20:64","73","Critical","8","AD Infrastructure Security","Execution","Lateral Movement","Privilege Escalation","","","","","Harden - Software Update","","This indicator checks for Domain Controllers running the print spooler service.
This indicator requires the local server to be running the print spooler service to function, or it will return Failed to run","The Windows print spooler service is vulnerable to remote code execution if unpatched, commonly referred to as PrintNightmare. These vulnerabilities are documented in CVE-2021-34527 and CVE-2021-1675.
The print spooler service can also be used by an attacker in combination with unconstrained Kerberos delegation and TGT delegation enabled across trusts.ReferencesWhat You Need to Know about PrintNightmare, the Critical Windows Print Spooler Vulnerability - Semperis
CVE-2021-34527 - Security Update Guide - Microsoft - Windows Print Spooler Remote Code Execution Vulnerability
CVE-2021-1675 - Security Update Guide - Microsoft - Windows Print Spooler Remote Code Execution Vulnerability
CVE-2019-0683 - Security Update Guide - Microsoft - Active Directory Elevation of Privilege Vulnerability","Found 1 DCs that have the Print Spooler service running.","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000077)","Print spooler services are enabled by default. If not absolutely required, disable the service on all domain controllers. If required, make sure the server is fully patched and follow Microsoft guidance <a href='https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527' target='_blank'>here</a>."
"SI000013","Evidence of Mimikatz DCShadow attack","1.124.1","AD","Pass","00:00:05:37","100","Critical","10","AD Infrastructure Security","Defense Evasion","","","","","","","Isolate - Execution Isolation","Detect - Domain Account Monitoring","This indicator checks for certain evidence of a DCShadow attack performed using Mimikatz.","DCShadow attacks allow attackers that have achieved privileged domain access to inject arbitrary changes into AD by replicating from a 'fake' domain controller. These changes bypass the security event log and can't be spotted using standard monitoring tools.
Mimikatz is a widely used tool used by both legitimate pen-testers as well as attackers. An attacker will use a DCShadow attack to establish persistence in Active Directory, creating backdoors to retain access even if the original privileged access compromise is resolvedReferencesWhy Most Organizations Still Can't Defend against DCShadow - Semperis","No evidence of exposure.","0","","None"
"SI000085","Unsecured DNS configuration","1.124.1","AD","Pass","00:00:07:29","100","Warning","7","AD Infrastructure Security","Privilege Escalation","","","","vuln1_dnszone_bad_prop","","","","","This indicator looks for DNS zones configured with ZONE_UPDATE_UNSECURE, which allows updating a DNS record anonymously.","An attacker could leverage this exposure to arbitrarily add a new DNS record or replace an existing record to spoof a management interface, then wait for incoming connections in order to steal credentials.","No evidence of exposure.","0","","None"
"SI000069","Domain Controllers in inconsistent state","1.124.1","AD","Pass","00:00:12:32","100","Informational","3","AD Infrastructure Security","Privilege Escalation","Resource Development","","","vuln1_dc_inconsistent_uac","","","","","This indicator looks for Domain Controllers that may be in an inconsistent state, indicating a possible rogue or otherwise non-functional DC. DCs in a consistent state are characterized by the following: 1. UserAccountControl attribute on the DC machine object has the SERVER_TRUST_ACCOUNT flag set. 2. A corresponding object of type server exists for the DC in the configuration partition. 3. That server object must have a child NTDS Settings object of type nTDSDSA.","Illegitimate machines acting as DCs could indicate someone has compromised the environment (e.g. using DCShadow or similar DC spoofing attacks). At the very least, partially functional legitimate DCs could represent a security risk if they are compromised.","No evidence of exposure.","0","","None"
"SI000051","Domains with obsolete functional levels","1.124.1","AD","Pass","00:00:11:61","100","Informational","3","AD Infrastructure Security","Reconnaissance","","","","vuln1_functional_level","vuln3_functional_level","vuln4_functional_level","Harden - Software Update","","This indicator looks for AD domains that have a domain functional level set to Windows Server 2012 R2 or lower. These lower functional levels mean that newer security features available in AD cannot be leveraged. If the OS version of your domain controllers supports it, you should update to a newer domain functional level to take full advantage of security advancements in AD.","While domain functional level is not a weakness in and of itself, an attacker with knowledge of functional levels can adjust their approach to take advantage of lack of security features in AD.","No evidence of exposure.","0","","None"
"SI000053","Operator groups no longer protected by AdminSDHolder and SDProp","1.124.1","AD","Pass","00:00:12:02","100","Warning","5","AD Infrastructure Security","Defense Evasion","","","","vuln1_dsheuristics_bad","","","Harden - User Account Permissions","","This indicator checks if dwAdminSDExMask mask on dsHeuristics has been set, which indicates a change to the SDProp behavior that could compromise security. Certain groups can be removed from SDProp protection with this setting.","Normally the default behavior for AdminSDHolder SDProp should be left intact. If its behavior is modified, this could indicate an attempt at defense evasion.","No evidence of exposure.","0","","None"
"SI000095","AD Certificate Authority with Web Enrollment - ESC8","1.124.1","AD","Pass","00:00:12:03","100","Critical","8","AD Infrastructure Security","Credential Access","Privilege Escalation","","","","","","","","This indicator attempts to identify AD CS servers in the domain that accept NTLM authentication to Web Enrollment Services. The script enumerates CAs in the Enrollment Services container, resolves their IP and attempts NTLM authentication to https://IP/certsrv and http://IP/certsrv. Note: This indicator currently does not identify EPA or other mitigations suggested by Microsoft.>

        The indicator will return a Passed if an enrollment service is contacted, but NTLM authentication is denied (positive effect on the posture score) for any endpoint.>

        The indicator will return an IoE Found if NTLM authentication is available on an enrollment service (negative effect on security posture) on any endpoint.>

        The indicator will Fail to Run (no effect on security posture score) if one of the following is true for all endpoints:>
Cannot Resolve - Enrollment Service Certificate found in AD CS container, but address cannot be resolvedUnreachable - IP is resolved, but service cannot be reached","Attackers may abuse a flaw in AD CS Web Enrollment that enables NTLM relay attacks to authenticate as a privileged user. An example of such attack was provided in July 2021 when chained with 'PetitPotam' authentication coercion on MS-EFSRPC. The impact of such an attack can be privilege escalation to Domain Admin from network access only. More details about 'ESC8' here.","No evidence of exposure.","0","","None"
"SI000072","gMSA objects with old passwords","1.124.1","AD","Pass","00:00:12:70","100","Warning","6","AD Infrastructure Security","Credential Access","","","","","","","","","This indicator looks for group managed service accounts that have not automatically rotated their passwords. These passwords should be changed automatically every 30 days by default.","gMSA accounts should automatically rotate their passwords every 30 days. Objects that are not doing this could show evidence of tampering.","No evidence of exposure.","0","","None"
"SI000073","Domain controllers that have not authenticated to the domain for more than 45 days","1.124.1","AD","Pass","00:00:15:51","100","Warning","4","AD Infrastructure Security","Credential Access","Privilege Escalation","","","vuln1_password_change_inactive_dc","","","Isolate - Execution Isolation","","Domain controllers must authenticate and change their passwords at least every 30 days. Lack of domain authentication reveals out-of-sync machines. Out-of-sync domain controllers must be either reinstalled or removed. When reinstalling an out-of-sync domain controller, care must be taken not to introduce a new OWNER control path exposing its computer account. To avoid doing so, use of the Djoin utility is advised.","Domain controllers that are not active in the domain would likely be out-of-sync with functional DCs and therefore a compromised offline DC may be of little value to an attacker. However, if an attacker could compromise an offline DC and crack credentials or re-connect it to the domain, they may be able to introduce unwanted changes to production AD that could compromise its security.","No evidence of exposure.","0","","None"
"SI000217","Query policies that have the attribute of ldap deny list set.","1.124.1","AD","Pass","00:00:15:60","100","Informational","5","AD Infrastructure Security","Impact","","","","","","","","","This security indicator is designed to check for LDAP IP deny lists across multiple domains in an Active Directory environment. For each available domain, it query the Active Directory for 'query policies' associated with that domain, specifically looking for LDAP IP deny lists (ldapipdenylist attribute).","Unauthorized or unexpected entries in the LDAP IP deny list could suggest a security breach or an attempt to limit access to critical resources maliciously. The likelihood of compromise depends on the following factors:Unexpected Changes: Unauthorized modifications to the LDAP IP deny list.Unknown IP Addresses: Presence of IP addresses that are not recognized or authorized by the network administration team.Security Policy Violations: Entries that violate the organization's established security policies.","No evidence of exposure.","0","","None"
"SI000153","LDAP signing is not required on Domain Controllers","1.124.1","AD","IOE Found","00:00:17:30","82","Warning","7","AD Infrastructure Security","Privilege Escalation","Credential Access","","","","","","","","This indicator checks for domain controllers where LDAP signing is not required.","Unsigned network traffic is exposed to MiTM attacks, where attackers alter packets and forward them to the LDAP server, causing the server to make decisions based on forged requests from the LDAP client.","Found 1 DCs that do not require LDAP Signing.","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000153)","<p>To remediate follow the steps below.</p><br /><p><b>If the steps are not followed in order, disruption to Active Directory may occur.</b></p><br /><p>Configure clients to request LDAP signing. Group policy: <b>Network security:LDAP client signing requirements</b>, select <b>Negotiate signing</b>.</p><br /><p>When all clients request signing, configure domain controllers to require LDAP signing. Group policy: <b>Domain controller:LDAP server signing requirements</b>, select <b>Require signing</b>.</p><br /><p>Configure clients to require LDAP signing. Group policy: <b>Network security:LDAP client signing requirements</b>, select <b>Require signing</b>.</p><br /><p>For full details on the process please see the reference articles.</p><h3>References</h3><p><a href='https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/domain-controller-ldap-server-signing-requirements' target='_blank'>Domain controller LDAP server signing requirements - Windows 10 | Microsoft Learn</a></p><br /><p><a href='https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/security-policy-settings/network-security-ldap-client-signing-requirements' target='_blank'>Network security LDAP client signing requirements - Windows 10 | Microsoft Learn</a></p>"
"SI000081","Non-standard schema permissions","1.124.1","AD","Pass","00:00:16:65","100","Warning","7","AD Infrastructure Security","Privilege Escalation","","","","vuln1_permissions_schema","","","Harden - System Configuration Permissions","","This indicator looks for additional  principals with any permissions beyond generic Read to the schema partitions.Schema is one of three main Active Directory naming context. It contains every object attribute definitions of the forest. For additional information and remediation advice, see the ANSSI website.","By default, modification permissions on schema are limited to Schema Admins. These permissions grant the trusted Principal complete control over Active Directory.","No evidence of exposure.","0","","None"
"SI000097","NTFRS SYSVOL Replication","1.124.1","AD","Pass","00:00:16:72","100","Warning","6","AD Infrastructure Security","Lateral Movement","","","","vuln2_sysvol_ntfrs","","","","","This indicator looks for indication of usage of FRS for sysvol replication. Domain controllers are configured to use the NTFRS replication protocol (especially for SYSVOL replication). This protocol is obsolete and unnecessarily adds administrative interfaces to domain controllers. In addition, this protocol is no longer supported by the latest versions of Windows Server, which prevents migration to the latest versions.","NTFRS is an older protocol that has been replaced by DFSR. Attackers that can manipulate NTFRS vulnerabilities to compromise SYSVOL can potentially change GPOs and logon scripts to propagate malware and move laterally across the environment.","No evidence of exposure.","0","","None"
"SI000088","Outbound forest trust with SID History enabled","1.124.1","AD","Pass","00:00:18:06","100","Warning","6","AD Infrastructure Security","Lateral Movement","","","","vuln1_trusts_forest_sidhistory","","","Harden - Domain Trust Policy","","This indicator checks for outbound forest trusts that have the TRUST_ATTRIBUTE_TREAT_AS_EXTERNAL flag set to true.","If TRUST_ATTRIBUTE_TREAT_AS_EXTERNAL is set to true, the security of a cross-forest trust is relaxed and trusts are treated as equivalent to external trusts.
An attacker that compromises the remote Active Directory forest, with this set to true, can spoof most users and computers in the local Active Directory forest. This would allow the attacker to act as local users or computers and access resources they have privileges in. An attacker can also use this for privilege elevation and compromise the local forest.ReferencesActive Directory Security Best Practices | Semperis","No evidence of exposure.","0","","None"
"SI000087","Domain trust to a third-party domain without quarantine","1.124.1","AD","Pass","00:00:17:99","100","Warning","5","AD Infrastructure Security","Lateral Movement","","","","vuln1_trusts_domain_notfiltered","","","Harden - Domain Trust Policy","","This indicator looks for outbound forest trusts that has Quarantine flag set to false, which means that the trusted domain is not subject to SID filtering.","An attacker having compromised the remote domain can spoof any user or machine on the local domain (except for accounts with a RID lower than 1000, excluding built-in accounts and groups). This attacker can therefore access every resource on the local domain. If a dangerous control path is exposed to any 'spoofable' account (virtually any account other than the built-in ones), the attacker could also escalate his privileges up to 'Domain Admins' and compromise the entire forest.","No evidence of exposure.","0","","None"
"SI000022","Risky RODC credential caching","1.124.1","AD","Pass","00:00:23:21","100","Warning","5","AD Infrastructure Security","Credential Access","","","","vuln2_rodc_priv_revealed","","","Harden - User Account Permissions","","This indicator checks the password replication policy on RODCs.","In many instances, read-only domain controllers (RODCs) are deployed in area where there is a lower level of physical security to the servers.
Attackers may try to target read-only domain controllers due to the lower level of security around these. While it is not a direct indicator of an attack, credentials for privileged users should not be cached on RODCs in the case the domain controller is compromised.ReferencesRODC Features | Microsoft Learn","No evidence of exposure.","0","","None"
"SI000138","Privileged user credentials cached on RODC","1.124.1","AD","Pass","00:00:25:36","100","Informational","4","AD Infrastructure Security","Lateral Movement","Privilege Escalation","","","","","","","","This indicator checks for privileged user credentials that are cached to RODCs.","In many instances, read-only domain controllers (RODCs) are deployed in area where there is a lower level of physical security to the servers.
Attackers may try to target read-only domain controllers due to the lower level of security around these. While it is not a direct indicator of an attack, credentials for privileged users should not be cached on RODCs in the case the domain controller is compromised.ReferencesRODC Features | Microsoft Learn","No evidence of exposure.","0","","None"
"SI000023","Well-known privileged SIDs in sIDHistory","1.124.1","AD","Pass","00:00:27:34","100","Critical","10","AD Infrastructure Security","Defense Evasion","Privilege Escalation","","","vuln2_sidhistory_dangerous","vuln3_sidhistory_present","","","","This indicator checks security principal sIDHistory for well-known privileged SIDs.","Security Identifier (SID) history is used by Active Directory to maintain access rights during domain migrations.
An attacker can abuse SID history by injecting a privileged SID into the sIDHistory of another user object, allowing the user to act with the same privileges. Writing to the sIDHistory does require privileges in Active Directory, so it is likely that Active Directory is already compromised; this method is primarily used by an attacker for gaining persistence.ResourcesHow to Defend Against SID History Injection | Semperis Guides","No evidence of exposure.","0","","None"
"SI000154","SMB Signing is not required on Domain Controllers","1.124.1","AD","Pass","00:00:27:73","100","Critical","8","AD Infrastructure Security","Privilege Escalation","Credential Access","","","","","","","","This indicator looks for domain controllers where SMB signing is not required.","Unsigned network traffic is susceptible to attacks abusing the NTLM challenge-response protocol. A common example of such attacks is SMB Relay, where an attacker is positioned between the client and the server in order to capture data packets transmitted between the two, thus gaining unauthorized access to the server or other servers on the network.","No evidence of exposure.","0","","None"
"SI000155","SMBv1 is enabled on Domain Controllers","1.124.1","AD","IOE Found","00:00:28:25","73","Critical","8","AD Infrastructure Security","Privilege Escalation","Credential Access","","","","","","","","This indicator looks for domain controllers where SMBv1 protocol is enabled.","SMBv1 is an old protocol, considered unsafe and susceptible to all kinds of attacks. It was publicly deprecated by Microsoft in 2014.","Found 1 DCs with SMBv1 Enabled.","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000155)","Microsoft recommends to disable SMBv1 whenever possible on both client and server side. Do note, before disabling SMBv1 and to avoid additional errors, make sure best practices are followed regarding the usage of deprecated OS (Windows 2000, 2003, XP, CE), network printers using SMBv1 scan2shares functionalities, or software accessing Windows share with a custom implementation relying on SMBv1. <br>Read more <a href='https://techcommunity.microsoft.com/t5/storage-at-microsoft/stop-using-smb1/ba-p/425858' target='_blank'>here.</a></br>"
"SI000086","Weak certificate cipher","1.124.1","AD","Pass","00:00:28:72","100","Critical","8","AD Infrastructure Security","Privilege Escalation","","","","vuln1_certificates_vuln","","","Harden - Certificate-based Authentication","","This indicator looks for  certificates stored in active directory with keysize smaller than 2048 bits or utilize DSA encryption.","Weak certificates can be abused by attackers to gain access to systems who use certificate authentication.","No evidence of exposure.","0","","None"
"SI000036","Zerologon vulnerability","1.124.1","AD","Not Selected","00:00:00:00","0","Critical","10","AD Infrastructure Security","Privilege Escalation","","","","","","","","","This indicator checks for security vulnerability CVE-202-1472.","Commonly referred to as Zerologon, CVE-2020-1472, is a vulnerability an attacker can use to gain Domain Administrator access against an unpatched domain controller. This vulnerability is considered critical because the attacker can perform the attack unauthenticated against Active Directory.ReferencesCVE-2020-1472 - Security Update Guide - Microsoft - Netlogon Elevation of Privilege Vulnerability","","0","",""
"SI000048","Changes to Default Domain Policy or Default Domain Controllers Policy in the last 7 days","1.124.1","AD","Pass","00:00:04:73","100","Informational","4","Group Policy Security","Lateral Movement","Persistence","","","","","","","","The Default Domain Policy and Default Domain Controllers Policy GPOs are special objects within AD, and control domain-wide and Domain Controller wide security settings. This indicator looks for changes to these two special GPOs within the last 7 days.","Changes to the Default Domain Policy or Default Domain Controllers Policy should be accounted for by the administrators. If the change can not be accounted for, investigate the change looking for potential weakening of security posture and why the change was made.","No evidence of exposure.","0","","None"
"SI000189","Writable shortcuts found in GPO","1.124.1","AD","Pass","00:00:14:93","100","Warning","6","Group Policy Security","Privilege Escalation","Lateral Movement","","","","","","Detect - Script Execution Analysis","Detect - File Creation Analysis","This indicator looks for shortcuts within Group Policy Objects (GPOs) that are writable by low privilege users. GPOs are a powerful feature in Windows domains that are used to manage various settings and configurations for multiple computers and users. Shortcuts are links to files or applications that can be deployed using GPOs. When low privilege users have the ability to modify these shortcuts, it could potentially lead to security risks and unauthorized modifications. This indicator helps organizations to identify such misconfigurations and take appropriate actions.","Changing a shortcut within a GPO, allows an attacker to perform the following:

            Unauthorized Modifications - Low privilege users could make unauthorized changes to the files, compromising their integrity and potentially causing unintended behavior or security vulnerabilities.

            Malicious Content Execution - If the files are replaced with malicious content, all users running them could unknowingly execute malicious code, leading to system compromise or unauthorized access to sensitive information.

            System Instability - Unauthorized modifications to files can result in system instability, causing application errors, data corruption, or system crashes.

            Compliance and Legal Consequences - If the affected files are critical for compliance or legal requirements, unauthorized modifications may lead to non-compliance, financial losses, reputational damage, or legal repercussions.","No evidence of exposure.","0","","None"
"SI000304","Dangerous GPO logon script path","1.124.1","AD","Pass","00:00:15:22","100","Warning","7","Group Policy Security","Privilege Escalation","Lateral Movement","","","","","","Detect - Script Execution Analysis","Detect - File Creation Analysis","This indicator searches for logon script paths where the script does not exist and where a low-privilege user has permissions on the parent folder. Additionally, it checks for logon script paths where the script exists but low-privilege users have permissions to modify them.","By inserting a new logon script or changing an existing one using normal user that has the permissions to do so, an attacker can remotely run code on a larger part of the network without special privileges.","No evidence of exposure.","0","","None"
"SI000316","GPO with Scheduled Tasks configured","1.124.1","AD","Pass","00:00:15:76","100","Informational","2","Group Policy Security","Privilege Escalation","Lateral Movement","","","","","","Detect - Script Execution Analysis","Detect - File Creation Analysis","When a scheduled task launches an executable, it checks to see if low-privilege users have permissions to modify GPOs.","Scheduled tasks configured through group policies can be risky if not set up correctly.
      They can cause unintended problems and potential security vulnerabilities in the following situations:>Missing path specification for executable files launched by the Task Scheduler: When setting up a scheduled task, it's important to provide the complete path to the executable file. This helps reduce the risk of path manipulation attacks. Path manipulation involves manipulating the search path or taking advantage of vulnerabilities in the path resolution mechanism to execute a malicious program. By explicitly specifying the complete path, you minimize the reliance on potentially vulnerable search path resolution mechanisms and decrease the chances of path manipulation exploits.>Executables located in unsecure locations: If scheduled tasks are configured to launch executables from locations where standard users have write access, it poses a potential risk. Standard users having write access to these directories can replace the intended program with a malicious one. This can lead to privilege escalation, where the malicious program gains higher privileges than it should have, resulting in security breaches and compromising the system's security.","No evidence of exposure.","0","","None"
"SI000302","Dangerous user rights granted by GPO","1.124.1","AD","Pass","00:00:17:30","100","Warning","7","Group Policy Security","Privilege Escalation","","","","","","","Detect - Local Account Monitoring","Harden - Strong Password Policy","Group Policy Objects (GPOs) are used to define security settings that apply to a group of users or computers in an Active Directory environment. GPOs can be used to grant dangerous user rights, such as the ability to bypass file system security, log on as a service, or even perform actions with elevated privileges. This indicator looks for non-privileged users who are granted elevated permissions through GPO.","An attacker can potentially exploit the user rights granted by a GPO to gain access to systems, steal sensitive information, or cause other types of damage. If these dangerous user rights are granted to a user or a group of users, it increases the risk of an attacker being able to gain access to sensitive data, systems or even perform malicious actions.","No evidence of exposure.","0","","None"
"SI000015","Reversible passwords found in GPOs","1.124.1","AD","Pass","00:00:15:56","100","Critical","8","Group Policy Security","Credential Access","","","","","","","Detect - Emulated File Analysis","","This indicator looks in SYSVOL for GPOs that contain passwords that can be easily decrypted by an attacker ('Cpassword' entries). Until patch MS14-025, it was possible to store local admin and other high-value credentials in GPOs. The passwords stored in GPOs were encrypted using a global key that was published and easily available to any domain member for decryption.","Many shops stopped using the feature in GP Preferences to set passwords when Microsoft deprecated the feature in Group Policy, but existing password entries may not have been removed. This area is one of the first things attackers look for when they've gained access to an AD environment, as older systems may still utilize those credentials.","No evidence of exposure.","0","","None"
"SI000101","SYSVOL Executable Changes","1.124.1","AD","Pass","00:00:28:04","100","Informational","3","Group Policy Security","Privilege Escalation","Execution","Persistence","","","","","Detect - File Analysis","","This indicator looks for modifications to executable files within SYSVOL. It only examines files and executables that have read access to them.","Changes to the executable files within SYSVOL should be accounted for by the administrators. If the change can not be accounted for, investigate the change looking for potential weakening of security posture and why the change was made.","No evidence of exposure.","0","","None"
"SI000041","GPO linking delegation at the AD Site level","1.124.1","AD","Pass","00:00:28:81","100","Warning","7","Group Policy Security","Privilege Escalation","Execution","","","vuln1_permissions_gpo_priv","","","","","When non-privileged users can link GPOs at the AD Site level, they have the ability to effect change on domain controllers as well as potentially elevate access and change domain-wide security posture. This indicator looks for non-default principals who have write permissions on the GPLink attribute or Write DACL/Write Owner on the object.","Just being able to link GPOs doesn't provide the whole picture. An attacker would need to find or edit a GPO that contains the instructions they want to achieve. However, if an attacker can find an existing GPO that meets their needs, then having this write permission gives them the keys to the kingdom.","No evidence of exposure.","0","","None"
"SI000040","GPO linking delegation at the domain controller OU level","1.124.1","AD","IOE Found","00:00:29:00","47","Warning","7","Group Policy Security","Privilege Escalation","Execution","","","vuln1_permissions_gpo_priv","","","","","When non-privileged users can link GPOs at the Domain Controllers OU level, they have the ability to effect change on domain controllers as well as potentially elevate access and change domain-wide security posture. This indicator looks for non-default principals who have write permissions on the GPLink attribute or Write DACL/Write Owner on the object.","Just being able to link GPOs doesn't provide the whole picture. An attacker would need to find or edit a GPO that contains the instructions they want to achieve. However, if an attacker can find an existing GPO that meets their needs, then having this write permission gives them the keys to the kingdom.","Found 3 objects with write permissions on the GPLink attribute at the Domain Controller OU level.","3","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000040)","Unprivileged users should not be able to link GPOs at the Domain Controllers OU level. Doing so essentially gives them the ability to escalate their access, change domain-level security posture, and use GPOs to effect all systems and users in AD. Remove unnecessary permissions from the DC OU."
"SI000032","GPO linking delegation at the domain level","1.124.1","AD","Pass","00:00:28:84","100","Warning","7","Group Policy Security","Defense Evasion","Privilege Escalation","","","vuln1_permissions_gpo_priv","","","","","When non-privileged users can link GPOs at the domain level, they have the ability to effect change across all users and computers in the domain as well as potentially elevate access and change domain-wide security posture. This indicator looks for non-default principals who have write permissions on the GPLink attribute or Write DACL/Write Owner on the object.","Just being able to link GPOs doesn't provide the whole picture. An attacker would need to find or edit a GPO that contains the instructions they want to achieve. However, if an attacker can find an existing GPO that meets their needs, then having this write permission gives them the keys to the kingdom.","No evidence of exposure.","0","","None"
"SI000102","Accounts with altSecurityIdentities configured","1.124.1","AD","Pass","00:00:04:33","100","Warning","7","Kerberos Security","Privilege Escalation","","","","vuln1_delegation_a2d2","","","","","It is possible to add values to the altSecurityIdentities attribute and essentially impersonate that account. The altSecurityIdentities attribute is a multi-valued attribute used to create mappings for X.509 certificates and external Kerberos accounts. This indicator checks for accounts with the altSecurityIdentities attribute configured.","This type of attack may be easy to spot as it is rarely configured during normal operations. However, it is possible for this attribute to be configured genuinely.","No evidence of exposure.","0","","None"
"SI000016","Computer or user accounts with SPN that have unconstrained delegation","1.124.1","AD","Pass","00:00:03:81","100","Warning","4","Kerberos Security","Defense Evasion","Lateral Movement","","","vuln2_delegation_t4d","","","Detect - Domain Account Monitoring","","This indicator looks for computer or user accounts with SPN that are trusted for unconstrained Kerberos delegation. These accounts store users' Kerberos TGT locally to authenticate to other systems on their behalf. Computers and users trusted with unconstrained delegation are good targets for Kerberos-based attacks.","Attackers who control a service or user trusted for unconstrained delegation can dump local credentials and uncover cached TGT. These credentials could belong to users that accessed the service and who may be privileged.","No evidence of exposure.","0","","None"
"SI000099","Accounts with Constrained Delegation configured to krbtgt","1.124.1","AD","Pass","00:00:04:57","100","Critical","9","Kerberos Security","Privilege Escalation","","","","vuln1_delegation_a2d2","","","Detect - Domain Account Monitoring","","This indicator checks for accounts that have constrained delegation configured to the KRBTGT account.","In Active Directory it is possible to create a Kerberos delegation to the KRBTGT account. This type of delegation to a user or computer would allow that principal to generate a ticket granting service (TGS) request to the KRBTGT account as any user.
An attacker may attempt to compromise any account that has a delegation to the KRBTGT account. This particular type of configuration allows for an attack similar to a Golden Ticket attack.","No evidence of exposure.","0","","None"
"SI000100","Accounts with Constrained Delegation configured to ghost SPN","1.124.1","AD","Pass","00:00:05:21","100","Warning","6","Kerberos Security","Privilege Escalation","","","","vuln1_delegation_a2d2","","","","","When computers are decommissioned, delegation configuration to them is often not cleaned up. Such a delegation could allow an attacker that has the privileges to write to the ServicePrincipalName attribute of another service account, to escalate privileges on those services. This could result in escalating privileges by moving laterally across the infrastructure. This indicator looks for accounts that have Constrained Delegation configured to ghost SPNs.","This type of attack should be easy to spot as the configured SPN within the msds-allowedtodelegateto attribute will not exist on the domain. However, if they are found, they would represent a significant risk and should be mitigated quickly.","No evidence of exposure.","0","","None"
"SI000017","Kerberos KRBTGT account with old password","1.124.1","AD","Pass","00:00:15:57","100","Warning","4","Kerberos Security","Credential Access","","","","vuln2_krbtgt","","","Harden - Strong Password Policy","","This indicator checks the age of the password on the KRBTGT account.","The KRBTGT user account is a special user account in Active Directory that is a service account for the Key Distribution Center (KDC).
If an attacker is able to compromise the KRBTGT account, they will be able to perform golden ticket attacks in Active Directory, which allow the attacker to impersonate any user.
Beyond rotating the password twice a year, it is recommended that the password is rotated every time someone who had privileged access in Active Directory, such as a Domain Admin, leaves the organization. There are specific steps that are required to successfully rotate the KRBTGT password, please see the reference article from Semperis for further details.ReferencesHow to Defend Against Golden Ticket Attacks on Active Directory - Semperis
The password for the krbtgt account on a domain must be reset at least every 180 days - stigviewer.com
Active Directory Accounts | Microsoft Learn","No evidence of exposure.","0","","None"
"SI000057","Objects with constrained delegation configured","1.124.1","AD","Pass","00:00:16:77","100","Informational","5","Kerberos Security","Lateral Movement","Privilege Escalation","","","","","","Detect - Domain Account Monitoring","","This indicator looks for any objects that have values in the msDS-AllowedToDelegateTo attribute (i.e. Constrained Delegation) and does not have the UserAccountControl bit for protocol transition set.","Attackers may utilize delegations to move laterally or escalate privileges if they compromise a service that is trusted to delegate. While constrained delegation is less likely to be compromised than unconstrained delegation, knowing all of the accounts within your environment that have this defined and ensuring they have strong passwords is a good thing.","No evidence of exposure.","0","","None"
"SI000070","Principals with constrained authentication delegation enabled for a DC service","1.124.1","AD","Pass","00:00:16:81","100","Warning","6","Kerberos Security","Privilege Escalation","","","","","","","Detect - Domain Account Monitoring","","This indicator looks for principals (computers or users) that have constrained delegation enabled for a service running on a DC. If an attacker can create such a delegation, they can authenticate to that service using any user that is not protected against delegation.","Constrained delegation allows a service to act on behalf of an authenticated user to another service. While this is sometimes necessary and requires the user to authenticate to the delegating service first, delegation to such services on domain controllers greatly increases risk. An attacker that is able to compromise such a service can significantly elevate their privileges in this way and infiltrate Active Directory.","No evidence of exposure.","0","","None"
"SI000058","Kerberos protocol transition delegation configured","1.124.1","AD","Pass","00:00:16:96","100","Warning","6","Kerberos Security","Credential Access","Lateral Movement","Privilege Escalation","","","","","","","This indicator looks for services that have been configured to allow Kerberos protocol transition. This capability enables a delegated service to use any available authentication protocol. This means that compromised services can reduce the quality of their authentication protocol to something that is more easily compromised (e.g. NTLM).","Protocol transition is not often used but when it is, it should be monitored closely for signs of abuse. In addition to compromising the authentication strength, this setting also allows attackers to request delegations with no authentication.","No evidence of exposure.","0","","None"
"SI000065","Principals with constrained delegation using protocol transition enabled for a DC service","1.124.1","AD","Pass","00:00:17:08","100","Warning","7","Kerberos Security","Privilege Escalation","","","","vuln1_delegation_t2a4d","","","","","This indicator looks for principals (computers or users) that have constrained delegation using protocol transition defined against a service running on a DC.","Protocol transition (also known as T2A4D) allows any user to authenticate to a delegated service using any protocol such as NTLM. This allows the delegated service to request a TGS from Kerberos for any user without any proof such as that user's corresponding TGT or TGS. If an attacker can create such a delegation for a service that they control or compromise an existing service, they can effectively gain a TGS for any user with privileges to the DC.","No evidence of exposure.","0","","None"
"SI000042","Users with SPN defined","1.124.1","AD","IOE Found","00:00:18:40","0","Informational","3","Kerberos Security","Privilege Escalation","","","","","","","Detect - Domain Account Monitoring","","This indicator provides a way to visually inventory all users accounts that have SPNs defined. Generally SPNs are only defined for 'Kerberized' services, so if you see an account with an SPN that should not have one, this could be cause for concern.","SPNs are generally only defined for service accounts or other services that use Kerberos. If you see SPNs on other accounts, they are worth investigating to determine if they are just an administrative error.","Found 50 users with associated SPN.","50","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000042)","If possible use Group Managed Service Accounts instead of regular users or ensure that all users that have an SPN are not primary users and considered as service accounts."
"SI000152","Primary users with SPN not supporting AES encryption on Kerberos","1.124.1","AD","IOE Found","00:00:19:95","0","Warning","5","Kerberos Security","Privilege Escalation","Credential Access","","","vuln3_kerberos_properties_encryption","","","","","This indicator shows all Primary users with SPNs that do not support AES-128 or AES-256 encryption type.","AES encryption is stronger than RC4 encryption. Configuring primary users with SPN to support AES encryption will not mitigate attacks such as Kerberoasting but does force AES by default, meaning that it is possible to monitor for encryption downgrade attacks to RC4 (Kerberoasting attacks)","Found 50 Primary users with SPN not supporting AES encryption","50","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000152)","Best practice is to enable AES encryption support on service accounts. Follow Microsoft guidance <a href='https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-configure-encryption-types-allowed-for-kerberos' target='_blank'>here.</a>"
"SI000019","Privileged users with SPN defined","1.124.1","AD","IOE Found","00:00:20:00","88","Warning","6","Kerberos Security","Credential Access","Privilege Escalation","","","vuln1_spn_priv","","","","","This indicator looks for accounts with the adminCount attribute set to 1 AND ServicePrincipalNames (SPNs) defined on the account. In general, privileged accounts should not have SPNs defined on them, as it makes them targets for Kerberos-based attacks that can elevate privileges to those accounts. By default, the krbtgt account falls under this category but is a special case and is not considered part of this indicator.","This is a significant issue that can allow an attacker to elevate privileges in a domain. Audit all accounts where privileged access is possible looking for anomalous access. If found, a breach or ongoing attack should be further investigated.","Found 1 privileged users with associated SPN.","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000019)","Remove SPN from privileged accounts when not required or mitigate by other means."
"SI000031","Computer account takeover through Kerberos Resource-Based Constrained Delegation (RBCD)","1.124.1","AD","Pass","00:00:20:48","100","Informational","5","Kerberos Security","Credential Access","Lateral Movement","Privilege Escalation","","","","","","","With sufficient permissions on a computer account and the ability to create another user or computer security principal, it is possible to compromise resources on that computer account using Kerberos resource-based constrained delegation (RBCD). This indicator looks for the msDS-AllowedToActOnBehalfOfOtherIdentity attribute on computer objects.","Attackers may utilize Kerberos RBCD configuration to escalate privileges through a computer they control if that computer has delegation to the target service.","No evidence of exposure.","0","","None"
"SI000066","Domain controllers with Resource-Based Constrained Delegation (RBCD) enabled","1.124.1","AD","Pass","00:00:20:51","100","Warning","6","Kerberos Security","Defense Evasion","Lateral Movement","Privilege Escalation","","vuln1_delegation_sourcedeleg","","","","","This indicator detects a configuration that grants certain accounts with complete delegation to domain controllers. Delegations towards privileged resources such as DCs should be avoided. Resource-based constrained delegation is configured on the target resource, as opposed to other delegation types that are configured on the accounts accessing the resource.","An attacker needs to know the Service Principal Name (SPN) of the object they want to delegate, as well as be able to populate the msDS-AllowedToActOnBehalfOfOtherIdentity attribute with a computer account that they control. This is sometimes possible when unprivileged users are by default allowed to create computer accounts (MachineAccountQuota) and write the attribute to the target computer.","No evidence of exposure.","0","","None"
"SI000071","krbtgt account with Resource-Based Constrained Delegation (RBCD) enabled","1.124.1","AD","Pass","00:00:20:50","100","Critical","9","Kerberos Security","Privilege Escalation","","","","vuln1_delegation_a2d2","","","","","This indicator checks if the KRBTGT account has resource-based constrained delegation (RBCD) defined.","In Active Directory it is possible to create a resource-based constrained delegation on the KRBTGT account.
An attacker may attempt to leverage this type of delegation to generate ticket granting service (TGS) requests to the KRBTGT account as any user. This particular type of attack is similar to a Golden Ticket attack.ResourcesResource-Based Constrained Delegation: Semperis AD 101","No evidence of exposure.","0","","None"
"SI000079","Write access to RBCD on DC","1.124.1","AD","IOE Found","00:00:20:84","88","Warning","6","Kerberos Security","Credential Access","","","","","","","","","This indicator looks for Write access on RBCD for Domain Controllers to users who are not in Domain Admins, Enterprise Admins and Built-in Admins groups.","This setting enables configuring RBCD on Domain Controllers. An attacker that is able to gain Write access to RBCD for a resource can cause that resource to impersonate any user (except where delegation is explicitly disallowed). Write on RBCD is always a high privilege, but when it is on a DC, the impact is substantial as an attacker can delegate to a controlled resource as a privileged user and abuse the DC services.","Found 1 DCs on which the listed principals can write to their msds-AllowedToActOnBehalfOfOtherIdentity attribute.","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000079)","For each DC listed, ensure that the principals who can set resource-based constrained delegation are valid."
"SI000080","Write access to RBCD on krbtgt account","1.124.1","AD","Pass","00:00:21:02","100","Warning","7","Kerberos Security","Credential Access","","","","","","","","","This indicator looks for Write access on RBCD for the krbtgt account to users who are not in Domain Admins, Enterprise Admins and Built-in Admins groups.","This setting enables configuring RBCD on the krbtgt account. An attacker that is able to gain Write access to RBCD for a resource can cause that resource to impersonate any user (except where delegation is explicitly disallowed). Write on RBCD is always a high privilege, but when it is on the krbtgt account, the impact is substantial because it allows the attacker to create TGS for krbtgt for any user, which can then be used as a TGT.","No evidence of exposure.","0","","None"
"SI000151","RC4 or DES encryption type are supported by Domain Controllers","1.124.1","AD","IOE Found","00:00:21:17","88","Warning","6","Kerberos Security","Privilege Escalation","Credential Access","","","vuln2_dc_crypto","vuln4_dc_crypto","","","","This indicator checks if RC4 or DES encryption is supported by Domain Controllers","RC4 and DES are considered an insecure form of encryption, susceptible to various cryptographic attacks. Multiple vulnerabilities in the RC4 and DES algorithms allow MitM and deciphering attacks. See CVE-2013-2566 and CVE-2015-2808.","Found 1 Domain Controllers that support RC4 or DES encryption","1","Security_Assessment_Report_5_30_2025_11_24_02_PM_(SI000151)","It is best practice to disable support for RC4 and DES on domain controllers. Proceed with caution, as this can cause clients that request RC4 encrypted kerberos tickets by default to fail.
        Disable it by adding the group policy Network security: Configure encryption types allowed for Kerberos and select only AES-128, AES-256 encryption types, to a GPO that affects the Domain Controllers container.
        The group policy path is Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options."
"SI000114","Resource Based Constrained Delegation applied to AZUREADSSOACC account","1.124.1","Hybrid (AD)","Not Relevant","00:00:03:71","0","Warning","5","Hybrid (AD)","Lateral Movement","Credential Access","","","","","","","","This indicator looks for Resource Based Constrained Delegation configured on the Entra Seamless SSO account.","When configuring Entra Seamless SSO, a computer account is created in Active Directory, AZUREADSSOACC. This computer account is used by Entra ID to decrypt Kerberos tickets that are used as part of the seamless SSO mechanism between Active Directory and Entra ID. If resource-based constrained delegation is configured on the AZUREADSSOACC computer account, an account with the delegation would be able to generate Ticket Granting Service (TGS) requests to Entra ID on behalf of the AZUREADSSOACC account, and impersonate any user in the Entra tenant that is synchronized from Active Directory.
An attacker can use this method to move laterally from Active Directory into Entra ID.ReferencesMicrosoft Entra Connect: Seamless Single Sign-On - How it works - Microsoft Entra ID | Microsoft Learn","This indicator is only relevant for environments with AAD Connect. No IDs for AAD Connect were detected in the environment.","0","","None"
"SI000133","SSO computer account with password last set over 90 days ago","1.124.1","Hybrid (AD)","Not Relevant","00:00:03:21","0","Warning","6","Hybrid (AD)","Credential Access","","","","vuln2_password_change_server_no_change_90","","","","","This indicator checks the Entra Seamless Single Sign-On computer account, AZUREADSSOACC, to determine if the password has been rotated in the last 90 days.","When configuring Entra Seamless SSO, a computer account is created in Active Directory, AZUREADSSOACC. This computer account is used by Entra ID to decrypt Kerberos tickets that are used as part of the seamless SSO mechanism between Active Directory and Entra ID. Because this is not an actual computer that is a member of Active Directory, the password for it cannot automatically be rolled over every 30 days. If an attacker compromises this account, they can generate Ticket Granting Service (TGS) request to Entra ID and impersonate any user in the Entra tenant that is synchronized from Active Directory.
An attacker can use this to move laterally from Active Directory into Entra ID.ReferencesMicrosoft Entra Connect SSO FAQ - Microsoft Entra ID | Microsoft Learn
Microsoft Entra Connect: Seamless Single Sign-On - How it works - Microsoft Entra ID | Microsoft Learn","This indicator is only relevant for environments with AAD Connect. No IDs for AAD Connect were detected in the environment.","0","","None"
